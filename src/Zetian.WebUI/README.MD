# Zetian.WebUI - Web Management Interface for SMTP

[![NuGet-Version](https://img.shields.io/nuget/v/Zetian.WebUI.svg?label=NuGet)](https://www.nuget.org/packages/Zetian.WebUI)
[![NuGet-Download](https://img.shields.io/nuget/dt/Zetian.WebUI?label=Download)](https://www.nuget.org/api/v2/package/Zetian.WebUI)
[![License](https://img.shields.io/github/license/Taiizor/Zetian.svg?label=License)](https://github.com/Taiizor/Zetian/blob/develop/LICENSE)

A modern, responsive web-based management interface for Zetian SMTP Server with real-time monitoring, REST API, and comprehensive administration features.

## âš¡ Features

- ğŸ“Š **Real-time Dashboard** - Live server metrics and statistics
- ğŸ“¨ **Message Management** - View, search, and manage email queue
- ğŸ‘¥ **Session Monitoring** - Track active SMTP sessions
- ğŸ” **Authentication Management** - Manage users and credentials
- ğŸ“ˆ **Performance Metrics** - Charts and graphs for server performance
- ğŸ› ï¸ **Configuration Editor** - Modify server settings on-the-fly
- ğŸ“ **Log Viewer** - Real-time log streaming with filtering
- ğŸ”„ **WebSocket Support** - Real-time updates via SignalR
- ğŸŒ **REST API** - Comprehensive API for automation
- ğŸ¨ **Modern UI** - Responsive design with dark mode support
- ğŸ”’ **Secure Access** - JWT authentication and role-based access

## ğŸ“¦ Installation

```bash
# Install Zetian SMTP Server (required)
dotnet add package Zetian

# Install WebUI Extension
dotnet add package Zetian.WebUI
```

## ğŸš€ Quick Start

### Basic Setup

```csharp
using Zetian.Server;
using Zetian.WebUI.Extensions;

// Create SMTP server
var server = SmtpServerBuilder.CreateBasic();

// Enable WebUI on port 8080
var webUI = server.EnableWebUI(8080);

// Start both services
await server.StartAsync();
await webUI.StartAsync();

// Access at http://localhost:8080
Console.WriteLine("WebUI available at http://localhost:8080");
```

### With Authentication

```csharp
// Enable WebUI with authentication
var webUI = server.EnableWebUI(options =>
{
    options.Port = 8080;
    options.RequireAuthentication = true;
    options.AdminUsername = "admin";
    options.AdminPassword = "secure_password";
    options.EnableApiKey = true;
    options.ApiKey = "your-api-key-here";
});

await webUI.StartAsync();
```

### Custom Configuration

```csharp
// Advanced WebUI configuration
var webUI = server.EnableWebUI(options =>
{
    options.Port = 8443;
    options.UseHttps = true;
    options.Certificate = certificate;
    options.BasePath = "/admin";
    options.EnableSwagger = true;
    options.EnableCors = true;
    options.CorsOrigins = new[] { "https://example.com" };
    options.MaxLogEntries = 10000;
    options.EnableMetricsEndpoint = true;
    options.SessionTimeout = TimeSpan.FromHours(2);
});
```

## ğŸ¯ Dashboard Features

### Real-time Metrics
- Active connections count
- Messages per second
- Total messages processed
- Error rate monitoring
- Memory and CPU usage
- Network throughput

### Session Management
```csharp
// Monitor sessions via WebUI API
GET /api/sessions          // List all active sessions
GET /api/sessions/{id}     // Get specific session details
POST /api/sessions/{id}/disconnect  // Disconnect a session
```

### Message Queue
```csharp
// Manage messages via API
GET /api/messages          // List messages
GET /api/messages/{id}     // Get message details
DELETE /api/messages/{id}  // Delete message
POST /api/messages/resend  // Resend message
```

## ğŸ“Š REST API

### Authentication
```bash
# Login to get JWT token
curl -X POST http://localhost:8080/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"admin","password":"password"}'

# Use token in subsequent requests
curl -X GET http://localhost:8080/api/server/status \
  -H "Authorization: Bearer {token}"
```

### Server Control
```csharp
POST /api/server/start     // Start SMTP server
POST /api/server/stop      // Stop SMTP server
POST /api/server/restart   // Restart server
GET /api/server/status     // Get server status
GET /api/server/config     // Get configuration
PUT /api/server/config     // Update configuration
```

### Statistics
```csharp
GET /api/stats/overview    // General statistics
GET /api/stats/messages    // Message statistics
GET /api/stats/errors      // Error statistics
GET /api/stats/performance // Performance metrics
GET /api/stats/history     // Historical data
```

## ğŸ”„ WebSocket Events

### Real-time Updates via SignalR

```javascript
// Connect to SignalR hub
const connection = new signalR.HubConnectionBuilder()
    .withUrl("/hubs/smtp")
    .build();

// Subscribe to events
connection.on("SessionCreated", (session) => {
    console.log("New session:", session);
});

connection.on("MessageReceived", (message) => {
    console.log("New message:", message);
});

connection.on("MetricsUpdate", (metrics) => {
    updateDashboard(metrics);
});

// Start connection
await connection.start();
```

### Available Events
- `SessionCreated`
- `SessionCompleted`
- `MessageReceived`
- `ErrorOccurred`
- `MetricsUpdate`
- `ConfigurationChanged`
- `AuthenticationAttempt`

## ğŸ› ï¸ Configuration Options

```csharp
public class WebUIOptions
{
    // Server settings
    public int Port { get; set; } = 8080;
    public string? HostName { get; set; }
    public string BasePath { get; set; } = "/";
    public bool UseHttps { get; set; } = false;
    public X509Certificate2? Certificate { get; set; }
    
    // Authentication
    public bool RequireAuthentication { get; set; } = true;
    public string AdminUsername { get; set; } = "admin";
    public string AdminPassword { get; set; } = "admin";
    public bool EnableApiKey { get; set; } = false;
    public string? ApiKey { get; set; }
    public TimeSpan SessionTimeout { get; set; } = TimeSpan.FromHours(1);
    
    // Features
    public bool EnableSwagger { get; set; } = true;
    public bool EnableSignalR { get; set; } = true;
    public bool EnableMetricsEndpoint { get; set; } = true;
    public bool EnableLogViewer { get; set; } = true;
    
    // CORS
    public bool EnableCors { get; set; } = false;
    public string[]? CorsOrigins { get; set; }
    
    // Limits
    public int MaxLogEntries { get; set; } = 5000;
    public int MaxSessionHistory { get; set; } = 1000;
    public int MetricsRetentionDays { get; set; } = 7;
}
```

## ğŸ¨ UI Customization

### Themes
```csharp
// Configure UI theme
webUI.ConfigureUI(ui =>
{
    ui.Theme = "dark";           // "light", "dark", "auto"
    ui.PrimaryColor = "#007bff";
    ui.LogoUrl = "/assets/logo.png";
    ui.Title = "My SMTP Server";
    ui.ShowFooter = true;
});
```

### Custom Pages
```csharp
// Add custom pages
webUI.AddCustomPage("/custom", "Custom Page", async context =>
{
    await context.Response.WriteAsync("Custom content");
});
```

## ğŸ“± Responsive Design

The WebUI is fully responsive and works on:
- ğŸ–¥ï¸ Desktop browsers
- ğŸ“± Mobile devices
- ğŸ“± Tablets
- ğŸ“º Large displays

## ğŸ”’ Security Features

- JWT-based authentication
- API key support
- HTTPS/TLS support
- CORS configuration
- Rate limiting
- Session management
- Role-based access control

## ğŸ“ˆ Monitoring Endpoints

### Prometheus Metrics
```
GET /metrics           # Prometheus-compatible metrics
```

### Health Check
```
GET /health           # Basic health check
GET /health/ready     # Readiness probe
GET /health/live      # Liveness probe
```

## ğŸŒ API Documentation

When Swagger is enabled, access the API documentation at:
```
http://localhost:8080/swagger
```

## ğŸ“š Advanced Usage

### Custom Middleware
```csharp
webUI.ConfigureApp(app =>
{
    app.UseMiddleware<CustomMiddleware>();
});
```

### Custom Controllers
```csharp
webUI.AddController<CustomSmtpController>();
```

### Event Handlers
```csharp
webUI.OnClientConnected += (sender, args) =>
{
    Console.WriteLine($"Client connected: {args.ClientId}");
};
```

## ğŸ—ï¸ Architecture

```
Zetian.WebUI/
â”œâ”€â”€ Api/                 # REST API controllers
â”œâ”€â”€ Hubs/               # SignalR hubs
â”œâ”€â”€ Services/           # Business logic
â”œâ”€â”€ Middleware/         # Custom middleware
â”œâ”€â”€ Models/             # Data models
â”œâ”€â”€ Options/           # Configuration
â”œâ”€â”€ wwwroot/           # Static files
â”‚   â”œâ”€â”€ css/          # Stylesheets
â”‚   â”œâ”€â”€ js/           # JavaScript
â”‚   â””â”€â”€ index.html    # SPA entry point
â””â”€â”€ Extensions/        # Extension methods
```

## ğŸ“‹ Requirements

- .NET 8.0, 9.0, or 10.0
- Zetian SMTP Server package
- Modern web browser
- (Optional) Reverse proxy for production

## ğŸš€ Production Deployment

### With Docker
```dockerfile
FROM mcr.microsoft.com/dotnet/aspnet:8.0
WORKDIR /app
COPY . .
EXPOSE 25 8080
ENTRYPOINT ["dotnet", "YourApp.dll"]
```

### With Nginx
```nginx
server {
    listen 80;
    server_name smtp.example.com;
    
    location / {
        proxy_pass http://localhost:8080;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
    }
}
```

## ğŸ“š Documentation & Support

- **Issues**: [GitHub Issues](https://github.com/Taiizor/Zetian/issues)
- **Examples**: [GitHub Examples](https://github.com/Taiizor/Zetian/tree/develop/examples)
- **Discussions**: [GitHub Discussions](https://github.com/Taiizor/Zetian/discussions)
- **Documentation**: [Zetian Documentation](https://zetian.soferity.com)

## ğŸ“„ License

MIT License - see [LICENSE](https://github.com/Taiizor/Zetian/blob/develop/LICENSE)